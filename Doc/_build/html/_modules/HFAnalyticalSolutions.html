
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>HFAnalyticalSolutions &#8212; PyFrac 1.0.1 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PyFrac 1.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for HFAnalyticalSolutions</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This file is part of PyFrac.</span>

<span class="sd">Created by Haseeb Zia on Wed Nov 16 18:33:56 2016.</span>
<span class="sd">Copyright (c) ECOLE POLYTECHNIQUE FEDERALE DE LAUSANNE, Switzerland, Geo-Energy Laboratory, 2016-2019. All rights reserved.</span>
<span class="sd">See the LICENSE.TXT file for more details.</span>

<span class="sd">Hydraulic fracture propagation Analytical solutions</span>
<span class="sd">notably for</span>
<span class="sd"> - planar radial fracture with constant injection rate</span>
<span class="sd"> - height contained fracture</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">interpolate</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">special</span>
<span class="kn">import</span> <span class="nn">scipy.integrate</span> <span class="k">as</span> <span class="nn">integrate</span>


<span class="c1">#  radial zero toughness turbulent MDR approximation</span>
<div class="viewcode-block" id="MDR_M_vertex_solution"><a class="viewcode-back" href="../doc_src/HFAnalyticalSolutions.html#HFAnalyticalSolutions.MDR_M_vertex_solution">[docs]</a><span class="k">def</span> <span class="nf">MDR_M_vertex_solution</span><span class="p">(</span><span class="n">Eprime</span><span class="p">,</span> <span class="n">Q0</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">visc</span><span class="p">,</span> <span class="n">Mesh</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="s1">&#39;111111&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       Analytical solution for a radial hydraulic fracture (zero toughness case) in the Max drag reduction flow regime</span>
<span class="sd">       propagation, given fracture radius or the time since the start of the injection. The solution does not take leak off into account.</span>

<span class="sd">       Arguments:</span>
<span class="sd">           Eprime (float)       -- plain strain elastic modulus.</span>
<span class="sd">           Q0 (float)           -- injection rate.</span>
<span class="sd">           density (float)      -- fluid density.</span>
<span class="sd">           visc (float)         -- fluid viscosity.</span>
<span class="sd">           Mesh (CartesianMesh) -- a CartesianMesh class object describing the grid.</span>
<span class="sd">           R (float)            -- the given radius for which the solution is evaluated.</span>
<span class="sd">           t (float)            -- time since the start of the injection.</span>

<span class="sd">       Returns:</span>
<span class="sd">           t (float)            -- time at which the fracture reaches the given radius.</span>
<span class="sd">           R (float)            -- radius of the fracture at the given time.</span>
<span class="sd">           p (ndarray)          -- pressure at each cell when the fracture has propagated to the given radius</span>
<span class="sd">           w (ndarray)          -- width opening at each cell when the fracture has propagated to the given radius or time</span>
<span class="sd">           v (float)            -- fracture propagation velocity</span>
<span class="sd">           actvElts (ndarray)   -- list of cells inside the fracture at the given time</span>
<span class="sd">       &quot;&quot;&quot;</span>
    <span class="n">fo</span> <span class="o">=</span> <span class="mf">1.78</span>
    <span class="n">gammam</span><span class="o">=</span> <span class="mf">0.758244</span>

    <span class="k">if</span> <span class="n">R</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either radius or time must be provided!&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="p">((</span><span class="mi">3</span><span class="o">**</span><span class="mf">0.175</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fo</span><span class="o">**</span><span class="mf">0.25</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">R</span><span class="o">**</span><span class="mf">2.175</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">visc</span><span class="o">**</span><span class="mf">0.175</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">density</span><span class="o">**</span><span class="mf">0.075</span><span class="p">))</span><span class="o">/</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mf">0.35</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Eprime</span><span class="o">**</span><span class="mf">0.25</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Q0</span><span class="o">**</span><span class="mf">0.675</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">gammam</span><span class="o">**</span><span class="mf">2.175</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">R</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">gammam</span><span class="o">*</span><span class="p">((</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="mf">14.</span><span class="o">/</span><span class="mi">87</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">Eprime</span><span class="o">**</span><span class="p">(</span><span class="mf">10.</span><span class="o">/</span><span class="mi">87</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">Q0</span><span class="o">**</span><span class="p">(</span><span class="mf">9.</span><span class="o">/</span><span class="mi">29</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="p">(</span><span class="mi">40</span><span class="o">/</span><span class="mi">87</span><span class="p">))</span>
                    <span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="mi">3</span><span class="o">**</span><span class="p">(</span><span class="mf">7.</span><span class="o">/</span><span class="mi">87</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">fo</span><span class="o">**</span><span class="p">(</span><span class="mf">10.</span><span class="o">/</span><span class="mi">87</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">visc</span><span class="o">**</span><span class="p">(</span><span class="mf">7.</span><span class="o">/</span><span class="mi">87</span><span class="p">))</span><span class="o">*</span><span class="n">density</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">29</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="p">(</span><span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">R</span>  <span class="c1"># normalized distance from center</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">rho</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># active cells (inside fracture)</span>
        <span class="n">var1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span>

        <span class="n">wscale</span> <span class="o">=</span><span class="p">((</span><span class="mi">3</span><span class="o">**</span><span class="mf">0.16091954022988506</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fo</span><span class="o">**</span><span class="mf">0.22988505747126436</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Q0</span><span class="o">**</span><span class="mf">0.3793103448275862</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mf">0.08045977011494253</span><span class="p">)</span><span class="o">*</span>
        <span class="p">(</span><span class="n">visc</span><span class="o">**</span><span class="mf">0.16091954022988506</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">density</span><span class="o">**</span><span class="mf">0.06896551724137931</span><span class="p">))</span><span class="o">/</span><span class="p">(</span>
        <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mf">0.3218390804597701</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Eprime</span><span class="o">**</span><span class="mf">0.22988505747126436</span><span class="p">))</span>

        <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Mesh</span><span class="o">.</span><span class="n">NumberOfElts</span><span class="p">,))</span>

        <span class="n">w</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">=</span> <span class="n">wscale</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.916848</span> <span class="o">*</span> <span class="p">(</span><span class="n">var1</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.740741</span> <span class="o">-</span> <span class="mf">0.283356</span> <span class="o">*</span> <span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">])</span> <span class="o">**</span> <span class="p">(</span><span class="mi">7</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.683013</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">var1</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.740741</span> <span class="o">*</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.500775</span> <span class="o">*</span> <span class="p">(</span><span class="n">var1</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.740741</span> <span class="o">*</span> <span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.07431</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">var1</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.740741</span> <span class="o">*</span> <span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">**</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.2138</span> <span class="o">*</span> <span class="p">(</span><span class="n">var1</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.740741</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">**</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.577514</span> <span class="o">*</span> <span class="p">(</span><span class="n">var1</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.740741</span> <span class="o">*</span> <span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">**</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.502666</span> <span class="o">*</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">-</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.718095</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">hyp2f1</span><span class="p">(</span>
            <span class="o">-</span><span class="p">(</span><span class="mi">7</span> <span class="o">/</span> <span class="mi">20</span><span class="p">),</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">13</span> <span class="o">/</span> <span class="mi">20</span><span class="p">,</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">**</span> <span class="mf">2.</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="p">(</span><span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">R</span>  <span class="c1"># normalized distance from center</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">rho</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># active cells (inside fracture)</span>
        <span class="n">var1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span>

        <span class="n">pscale</span> <span class="o">=</span> <span class="p">((</span><span class="mi">3</span><span class="o">**</span><span class="mf">0.2413793103448276</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Eprime</span><span class="o">**</span><span class="mf">0.6551724137931034</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fo</span><span class="o">**</span><span class="mf">0.3448275862068966</span><span class="p">)</span><span class="o">*</span><span class="p">(</span>
            <span class="n">Q0</span><span class="o">**</span><span class="mf">0.06896551724137931</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">visc</span><span class="o">**</span><span class="mf">0.2413793103448276</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">density</span><span class="o">**</span><span class="mf">0.10344827586206896</span><span class="p">))</span><span class="o">/</span><span class="p">(</span>
            <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mf">0.4827586206896552</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mf">0.3793103448275862</span><span class="p">))</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Mesh</span><span class="o">.</span><span class="n">NumberOfElts</span><span class="p">,))</span>

        <span class="n">p</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">=</span> <span class="n">pscale</span> <span class="o">*</span> <span class="p">(</span>
            <span class="mf">0.5948935210154036</span> <span class="o">-</span> <span class="mf">0.2717984030270058</span> <span class="o">/</span> <span class="p">(</span><span class="n">var1</span> <span class="o">**</span> <span class="mf">0.25925925925925924</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.23531180369007717855</span> <span class="o">/</span> <span class="p">(</span>
            <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">**</span> <span class="mf">0.3</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.16828914936530234</span> <span class="o">*</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">var1</span> <span class="o">**</span> <span class="mf">0.25925925925925924</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span>
            <span class="mf">0.2225733568270942</span> <span class="o">*</span> <span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">var1</span> <span class="o">**</span> <span class="mf">0.25925925925925924</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.2158763695654084</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">**</span> <span class="mi">3</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">var1</span> <span class="o">**</span> <span class="mf">0.25925925925925924</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.07471989686220308</span> <span class="o">*</span> <span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">**</span> <span class="mi">4</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
            <span class="n">var1</span> <span class="o">**</span> <span class="mf">0.25925925925925924</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">actvElts</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">p</span><span class="p">[</span><span class="n">p</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">NINF</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">p</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">NINF</span><span class="p">])</span>
            <span class="n">p</span><span class="p">[</span><span class="n">p</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">Inf</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">p</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">gammam</span> <span class="o">*</span> <span class="mf">0.45977011494252873</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">**</span> <span class="p">(</span><span class="mf">0.45977011494252873</span><span class="o">-</span><span class="mf">1.</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span>
            <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="mf">0.16091954022988506</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">Eprime</span> <span class="o">**</span> <span class="mf">0.11494252873563218</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">Q0</span> <span class="o">**</span> <span class="mf">0.3103448275862069</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span>
            <span class="p">((</span><span class="mi">3</span> <span class="o">**</span> <span class="mf">0.08045977011494253</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">fo</span> <span class="o">**</span> <span class="mf">0.11494252873563218</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">visc</span> <span class="o">**</span> <span class="mf">0.08045977011494253</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">density</span><span class="o">**</span> <span class="mf">0.034482758620689655</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">required</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">required</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span> <span class="ow">or</span> <span class="n">required</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">)):</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">actvElts</span></div>

<span class="c1"># ----------------------------------------------------------------------------------------------------------------------</span>


<div class="viewcode-block" id="M_vertex_solution"><a class="viewcode-back" href="../doc_src/HFAnalyticalSolutions.html#HFAnalyticalSolutions.M_vertex_solution">[docs]</a><span class="k">def</span> <span class="nf">M_vertex_solution</span><span class="p">(</span><span class="n">Eprime</span><span class="p">,</span> <span class="n">Q0</span><span class="p">,</span> <span class="n">muPrime</span><span class="p">,</span> <span class="n">Mesh</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="s1">&#39;111111&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Analytical solution for Viscosity dominated (M vertex) fracture propagation, given fracture radius or the time</span>
<span class="sd">    since the start of the injection. The solution does not take leak off into account.</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">        Eprime (float)       -- plain strain elastic modulus.</span>
<span class="sd">        Q0 (float)           -- injection rate.</span>
<span class="sd">        muPrime (float)      -- 12*viscosity.</span>
<span class="sd">        Mesh (CartesianMesh) -- a CartesianMesh class object describing the grid.</span>
<span class="sd">        R (float)            -- the given radius for which the solution is evaluated.</span>
<span class="sd">        t (float)            -- time since the start of the injection.</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        t (float)            -- time at which the fracture reaches the given radius.</span>
<span class="sd">        R (float)            -- radius of the fracture at the given time.</span>
<span class="sd">        p (ndarray)          -- pressure at each cell when the fracture has propagated to the given radius</span>
<span class="sd">        w (ndarray)          -- width opening at each cell when the fracture has propagated to the given radius or time</span>
<span class="sd">        v (float)            -- fracture propagation velocity</span>
<span class="sd">        actvElts (ndarray)   -- list of cells inside the fracture at the given time</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">R</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either radius or time must be provided!&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.24846</span> <span class="o">*</span> <span class="n">R</span> <span class="o">**</span> <span class="p">(</span><span class="mi">9</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="n">muPrime</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">Eprime</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="n">Q0</span> <span class="o">**</span> <span class="p">(</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">4</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">R</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">R</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.6976</span> <span class="o">*</span> <span class="n">Eprime</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">9</span><span class="p">)</span> <span class="o">*</span> <span class="n">Q0</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span> <span class="o">**</span> <span class="p">(</span><span class="mi">4</span> <span class="o">/</span> <span class="mi">9</span><span class="p">))</span> <span class="o">/</span> <span class="n">muPrime</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">9</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span> <span class="o">/</span> <span class="mi">9</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">**</span> <span class="p">(</span><span class="mi">4</span> <span class="o">/</span> <span class="mi">9</span> <span class="o">-</span><span class="mf">1.</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span><span class="mf">0.6976</span> <span class="o">*</span> <span class="n">Eprime</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">9</span><span class="p">)</span> <span class="o">*</span> <span class="n">Q0</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">muPrime</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">9</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="p">(</span><span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">R</span>  <span class="c1"># normalized distance from center</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">rho</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># active cells (inside fracture)</span>
        <span class="c1"># temporary variables to avoid recomputation</span>
        <span class="n">var1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span>
        <span class="n">var2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span>

        <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Mesh</span><span class="o">.</span><span class="n">NumberOfElts</span><span class="p">,))</span>
        <span class="n">w</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">Eprime</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">9</span><span class="p">)))</span> <span class="o">*</span> <span class="mf">0.6976</span> <span class="o">*</span> <span class="n">Q0</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">9</span><span class="p">)</span> <span class="o">*</span> <span class="n">muPrime</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">9</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
                <span class="mf">1.89201</span> <span class="o">*</span> <span class="n">var2</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.000663163</span> <span class="o">*</span> <span class="n">var2</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
                <span class="mi">35</span> <span class="o">/</span> <span class="mi">9</span> <span class="o">+</span> <span class="mi">80</span> <span class="o">/</span> <span class="mi">9</span> <span class="o">*</span> <span class="n">var1</span> <span class="o">+</span> <span class="mi">38</span> <span class="o">/</span> <span class="mi">9</span> <span class="o">*</span> <span class="n">var1</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.00314291</span> <span class="o">*</span> <span class="n">var2</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
                <span class="mi">455</span> <span class="o">/</span> <span class="mi">81</span> <span class="o">+</span> <span class="mi">1235</span> <span class="o">/</span> <span class="mi">54</span> <span class="o">*</span> <span class="n">var1</span> <span class="o">+</span> <span class="mi">2717</span> <span class="o">/</span> <span class="mi">108</span> <span class="o">*</span> <span class="n">var1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">5225</span> <span class="o">/</span> <span class="mi">648</span> <span class="o">*</span> <span class="n">var1</span> <span class="o">**</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.000843517</span> <span class="o">*</span> <span class="n">var2</span> <span class="o">**</span> <span class="p">(</span>
                <span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1820</span> <span class="o">/</span> <span class="mi">243</span> <span class="o">+</span> <span class="mi">11440</span> <span class="o">/</span> <span class="mi">243</span> <span class="o">*</span> <span class="n">var1</span> <span class="o">+</span> <span class="mi">7150</span> <span class="o">/</span> <span class="mi">81</span> <span class="o">*</span> <span class="n">var1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">15400</span> <span class="o">/</span> <span class="mi">243</span> <span class="o">*</span> <span class="n">var1</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">+</span> <span class="p">(</span>
                <span class="mi">59675</span> <span class="o">*</span> <span class="n">var1</span> <span class="o">**</span> <span class="mi">4</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3888</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.102366</span> <span class="o">*</span> <span class="n">var2</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">13</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">])</span>
                <span class="p">)</span> <span class="o">+</span> <span class="mf">0.237267</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">])))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Mesh</span><span class="o">.</span><span class="n">NumberOfElts</span><span class="p">,))</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="p">(</span><span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">R</span> <span class="c1"># normalized distance from center</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">rho</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># active cells (inside fracture)</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

        <span class="n">p</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0931746</span> <span class="o">*</span> <span class="n">Eprime</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">muPrime</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">2.20161</span> <span class="o">+</span> <span class="mf">8.81828</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span>
                        <span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.0195787</span> <span class="o">*</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.171565</span> <span class="o">*</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span>
                        <span class="mf">0.103558</span> <span class="o">*</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">])</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]))</span>
                       <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">t</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">])</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">actvElts</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">p</span><span class="p">[</span><span class="n">p</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">NINF</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">p</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">NINF</span><span class="p">])</span>
            <span class="n">p</span><span class="p">[</span><span class="n">p</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">Inf</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">p</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">required</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">required</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span> <span class="ow">or</span> <span class="n">required</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">)):</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">actvElts</span></div>

<span class="c1"># ----------------------------------------------------------------------------------------------------------------------</span>

<div class="viewcode-block" id="K_vertex_solution"><a class="viewcode-back" href="../doc_src/HFAnalyticalSolutions.html#HFAnalyticalSolutions.K_vertex_solution">[docs]</a><span class="k">def</span> <span class="nf">K_vertex_solution</span><span class="p">(</span><span class="n">Kprime</span><span class="p">,</span> <span class="n">Eprime</span><span class="p">,</span> <span class="n">Q0</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="s1">&#39;111111&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Analytical solution for toughness dominated (K vertex) fracture propagation, given current radius or time. The</span>
<span class="sd">    solution does not take leak off into account.</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">        Kprime (float)          -- 4*(2/pi)**0.5 * K1c, where K1c is the linear-elastic plane-strain fracture toughness</span>
<span class="sd">        Eprime (float)          -- plain strain elastic modulus</span>
<span class="sd">        Q0 (float)              -- injection rate</span>
<span class="sd">        Mesh (CartesianMesh)    -- a CartesianMesh class object describing the grid.</span>
<span class="sd">        R (float)               -- the given radius for which the solution is evaluated.</span>
<span class="sd">        t (float)               -- time since the start of the injection.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        t (float)               -- time at which the fracture reaches the given radius.</span>
<span class="sd">        R (float)               -- radius of the fracture at the given time.</span>
<span class="sd">        p (ndarray)             -- pressure at each cell when the fracture has propagated to the given radius</span>
<span class="sd">        w (ndarray)             -- width opening at each cell when the fracture has propagated to the given radius or time</span>
<span class="sd">        v (float)               -- fracture propagation velocity</span>
<span class="sd">        actvElts (ndarray)      -- list of cells inside the fracture at the given time</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">R</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either radius or time must be provided!&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">Kprime</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">R</span> <span class="o">**</span> <span class="p">(</span><span class="mi">5</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">Eprime</span> <span class="o">*</span> <span class="n">Q0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">R</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">R</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">Q0</span> <span class="o">*</span> <span class="n">Eprime</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="n">Kprime</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.4</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">8</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">12</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">Kprime</span> <span class="o">**</span> <span class="mi">6</span> <span class="o">/</span> <span class="p">(</span><span class="n">Eprime</span> <span class="o">*</span> <span class="n">Q0</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span>
            <span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">NumberOfElts</span><span class="p">,),</span> <span class="nb">float</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">mesh</span><span class="o">.</span><span class="n">NumberOfElts</span><span class="p">,))</span>
        <span class="n">rad</span> <span class="o">=</span> <span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="c1"># distance from center</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">rad</span> <span class="o">&lt;</span> <span class="n">R</span><span class="p">)</span> <span class="c1"># active cells (inside fracture)</span>
        <span class="n">w</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">8</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="p">(</span><span class="n">Q0</span> <span class="o">*</span> <span class="n">Kprime</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="n">Eprime</span> <span class="o">**</span> <span class="mi">4</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="p">(</span>
                      <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">rad</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">/</span> <span class="n">R</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="c1"># todo Hack: The velocity is evaluated with time taken by the fracture to advance by one percent</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">Kprime</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.01</span> <span class="o">*</span> <span class="n">R</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">5</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">Eprime</span> <span class="o">*</span> <span class="n">Q0</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">R</span> <span class="o">/</span> <span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">required</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">required</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span> <span class="ow">or</span> <span class="n">required</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">)):</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">actvElts</span></div>

<span class="c1">#-----------------------------------------------------------------------------------------------------------------------</span>


<div class="viewcode-block" id="Mt_vertex_solution"><a class="viewcode-back" href="../doc_src/HFAnalyticalSolutions.html#HFAnalyticalSolutions.Mt_vertex_solution">[docs]</a><span class="k">def</span> <span class="nf">Mt_vertex_solution</span><span class="p">(</span><span class="n">Eprime</span><span class="p">,</span> <span class="n">Cprime</span><span class="p">,</span> <span class="n">Q0</span><span class="p">,</span> <span class="n">muPrime</span><span class="p">,</span> <span class="n">Mesh</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="s1">&#39;111111&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Analytical solution for viscosity dominated (M tilde vertex) fracture propagation, given current time. The solution</span>
<span class="sd">    takes leak off into account.</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">        Eprime (float)         -- plain strain elastic modulus</span>
<span class="sd">        Cprime (float)         -- 2*C, where C is the Carter&#39;s leak off coefficient</span>
<span class="sd">        Q0 (float)             -- injection rate</span>
<span class="sd">        muPrime (float)        -- 12*viscosity</span>
<span class="sd">        Mesh (CartesianMesh)   -- a CartesianMesh class object describing the grid.</span>
<span class="sd">        R (float)              -- the given radius for which the solution is evaluated</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        t (float)               -- time at which the fracture reaches the given radius.</span>
<span class="sd">        R (float)               -- radius of the fracture at the given time.</span>
<span class="sd">        p (ndarray)             -- pressure at each cell when the fracture has propagated to the given radius</span>
<span class="sd">        w (ndarray)             -- width opening at each cell when the fracture has propagated to the given radius or time</span>
<span class="sd">        v (float)               -- fracture propagation velocity</span>
<span class="sd">        actvElts (ndarray)      -- list of cells inside the fracture at the given time</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">R</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either radius or time must be provided!&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">Cprime</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;leak off cannot be zero for Mt regime!&quot;</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">Cprime</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">R</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">Q0</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">R</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">Cprime</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;leak off cannot be zero for Mt regime!&quot;</span><span class="p">)</span>
        <span class="n">R</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Q0</span> <span class="o">/</span> <span class="n">Cprime</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span> <span class="o">**</span> <span class="mf">0.25</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Mesh</span><span class="o">.</span><span class="n">NumberOfElts</span><span class="p">,))</span>

        <span class="n">rho</span> <span class="o">=</span> <span class="p">(</span><span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">R</span> <span class="c1"># normalized distance from center</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">rho</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># active cells (inside fracture)</span>

        <span class="c1"># temporary variables to avoid recomputation</span>
        <span class="n">var1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">])</span> <span class="o">**</span> <span class="mf">0.375</span>
        <span class="n">var2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">])</span> <span class="o">**</span> <span class="mf">0.625</span>

        <span class="c1"># todo: cite where the solution is taken from</span>
        <span class="n">w</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.07627790025007182</span> <span class="o">*</span> <span class="n">Q0</span> <span class="o">**</span> <span class="mf">0.375</span> <span class="o">*</span> <span class="n">t</span> <span class="o">**</span> <span class="mf">0.0625</span> <span class="o">*</span> <span class="n">muPrime</span> <span class="o">**</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span>
        <span class="mf">11.40566553791626</span> <span class="o">*</span> <span class="n">var2</span> <span class="o">+</span> <span class="mf">7.049001601162521</span> <span class="o">*</span> <span class="n">var2</span> <span class="o">*</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.6802327798216378</span> <span class="o">*</span> <span class="n">var2</span> <span class="o">*</span> <span class="n">rho</span><span class="p">[</span>
        <span class="n">actvElts</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">0.828297356390819</span> <span class="o">*</span> <span class="n">var2</span> <span class="o">*</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">var2</span> <span class="o">*</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">+</span> <span class="mf">2.350633434009811</span>
        <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="mf">2.350633434009811</span> <span class="o">*</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">])))</span> <span class="o">/</span> <span class="p">(</span>
                  <span class="n">Cprime</span> <span class="o">**</span> <span class="mf">0.125</span> <span class="o">*</span> <span class="n">Eprime</span> <span class="o">**</span> <span class="mf">0.25</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="p">(</span><span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">R</span>  <span class="c1"># normalized distance from center</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">rho</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># active cells (inside fracture)</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Mesh</span><span class="o">.</span><span class="n">NumberOfElts</span><span class="p">,))</span>
        <span class="n">p</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.156415</span> <span class="o">*</span> <span class="n">Cprime</span> <span class="o">**</span> <span class="mf">0.375</span> <span class="o">*</span> <span class="n">Eprime</span> <span class="o">**</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="n">muPrime</span> <span class="o">**</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span>
        <span class="o">-</span><span class="mf">1.0882178530759854</span> <span class="o">+</span> <span class="mf">6.3385626500863985</span> <span class="o">*</span> <span class="n">var1</span> <span class="o">-</span> <span class="mf">0.07314343477396379</span> <span class="o">*</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.21802875891750756</span>
        <span class="o">*</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">0.04996007983993901</span> <span class="o">*</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">+</span> <span class="mf">1.</span> <span class="o">*</span> <span class="n">var1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">])))</span> <span class="o">/</span> <span class="p">(</span>
        <span class="n">Q0</span> <span class="o">**</span> <span class="mf">0.125</span> <span class="o">*</span> <span class="n">var1</span> <span class="o">*</span> <span class="n">t</span> <span class="o">**</span> <span class="mf">0.1875</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">actvElts</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">p</span><span class="p">[</span><span class="n">p</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">NINF</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">p</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">NINF</span><span class="p">])</span>
            <span class="n">p</span><span class="p">[</span><span class="n">p</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">Inf</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">p</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="c1"># todo Hack: The velocity is evaluated with time taken by the fracture to advance by one percent</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">Cprime</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.01</span> <span class="o">*</span> <span class="n">R</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">/</span> <span class="n">Q0</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">v</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">R</span> <span class="o">/</span> <span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">required</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">required</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span> <span class="ow">or</span> <span class="n">required</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">)):</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">actvElts</span></div>

<span class="c1">#-----------------------------------------------------------------------------------------------------------------------</span>


<div class="viewcode-block" id="KT_vertex_solution"><a class="viewcode-back" href="../doc_src/HFAnalyticalSolutions.html#HFAnalyticalSolutions.KT_vertex_solution">[docs]</a><span class="k">def</span> <span class="nf">KT_vertex_solution</span><span class="p">(</span><span class="n">Eprime</span><span class="p">,</span> <span class="n">Cprime</span><span class="p">,</span> <span class="n">Q0</span><span class="p">,</span> <span class="n">Kprime</span><span class="p">,</span> <span class="n">Mesh</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="s1">&#39;111111&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Analytical solution for viscosity dominated (M tilde vertex) fracture propagation, given the current time or the</span>
<span class="sd">    radius.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        Eprime (float)      -- plain strain elastic modulus</span>
<span class="sd">        Cprime (float)      -- 2*C, where C is the Carter&#39;s leak off coefficient</span>
<span class="sd">        Q0 (float)          -- injection rate</span>
<span class="sd">        Kprime (float)      -- 4*(2/pi)**0.5 * K1c, where K1c is the linear-elastic plane-strain fracture toughness</span>
<span class="sd">        Mesh (CartesianMesh)-- a CartesianMesh class object describing the grid.</span>
<span class="sd">        t (float)           -- the given time for which the solution is evaluated. Either of the time or radius can</span>
<span class="sd">                               be provided</span>
<span class="sd">        R (float)           -- the given radius for which the solution is evaluated. Either of the time or radius can</span>
<span class="sd">                               be provided</span>

<span class="sd">    Returns:</span>
<span class="sd">        t (float)           -- time at which the fracture reaches the given radius.</span>
<span class="sd">        R (float)           -- radius of the fracture at the given time.</span>
<span class="sd">        p (ndarray)         -- pressure at each cell when the fracture has propagated to the given radius</span>
<span class="sd">        w (ndarray)         -- width opening at each cell when the fracture has propagated to the given radius or time</span>
<span class="sd">        v (float)           -- fracture propagation velocity</span>
<span class="sd">        actvElts (ndarray)  -- list of cells inside the fracture at the given time</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">if</span> <span class="n">R</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either the time or the radius is required to evaluate the solution.&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">R</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">Cprime</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;leak off cannot be zero for Kt regime!&quot;</span><span class="p">)</span>
        <span class="n">R</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">Q0</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">/</span> <span class="n">Cprime</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="k">elif</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">Cprime</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;leak off cannot be zero for Kt regime!&quot;</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">Cprime</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Q0</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Mesh</span><span class="o">.</span><span class="n">NumberOfElts</span><span class="p">,))</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="p">(</span><span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">R</span>  <span class="c1"># normalized distance from center</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">rho</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># active cells (inside fracture)</span>
        <span class="n">w</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">=</span> <span class="n">Kprime</span> <span class="o">*</span> <span class="n">Q0</span><span class="o">**</span><span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">rho</span><span class="p">[</span><span class="n">actvElts</span><span class="p">])</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mf">0.125</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mf">0.25</span> <span class="o">*</span> <span class="n">Cprime</span><span class="o">**</span><span class="mf">0.25</span> <span class="o">*</span>
                                                                               <span class="n">Eprime</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="p">(</span><span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">R</span>  <span class="c1"># normalized distance from center</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">rho</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># active cells (inside fracture)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Mesh</span><span class="o">.</span><span class="n">NumberOfElts</span><span class="p">,))</span>
        <span class="n">p</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">=</span> <span class="n">Cprime</span><span class="o">**</span><span class="mf">0.25</span> <span class="o">*</span> <span class="n">Kprime</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="n">Q0</span><span class="o">**</span><span class="mf">0.25</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mf">0.125</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="c1"># todo Hack: The velocity is evaluated with time taken by the fracture to advance by one percent</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.01</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">Cprime</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Q0</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span>
        <span class="n">v</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">R</span> <span class="o">/</span> <span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">required</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">required</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span> <span class="ow">or</span> <span class="n">required</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">)):</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">actvElts</span></div>

<span class="c1">#-----------------------------------------------------------------------------------------------------------------------</span>


<div class="viewcode-block" id="PKN_solution"><a class="viewcode-back" href="../doc_src/HFAnalyticalSolutions.html#HFAnalyticalSolutions.PKN_solution">[docs]</a><span class="k">def</span> <span class="nf">PKN_solution</span><span class="p">(</span><span class="n">Eprime</span><span class="p">,</span> <span class="n">Q0</span><span class="p">,</span> <span class="n">muPrime</span><span class="p">,</span> <span class="n">Mesh</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">ell</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="s1">&#39;111111&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Analytical solution for heigth contained hydraulic fracture (PKN geometry), given current time. The solution</span>
<span class="sd">    does not take leak off into account.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        Eprime (float)         -- plain strain elastic modulus</span>
<span class="sd">        Q0 (float)             -- injection rate</span>
<span class="sd">        muPrime (float)        -- 12*viscosity</span>
<span class="sd">        Mesh (CartesianMesh)   -- a CartesianMesh class object describing the grid.</span>
<span class="sd">        t (float)              -- the given time for which the solution is evaluated</span>
<span class="sd">        h (float)              -- the height of the PKN fracture</span>

<span class="sd">    Returns:</span>
<span class="sd">        t (float)              -- time at which the fracture reaches the given length.</span>
<span class="sd">        ell (float)            -- length of the fracture at the given time</span>
<span class="sd">        p (ndarray-float)      -- pressure at each cell at the given time</span>
<span class="sd">        w (ndarray-float)      -- width at each cell at the given time</span>
<span class="sd">        v (float)              -- propagation velocity</span>
<span class="sd">        actvElts (ndarray)     -- list of cells inside the PKN fracture at the given time</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">ell</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either the length or the time is required to evaluate the solution.&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">ell</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># length of the fracture at the given time</span>
        <span class="n">ell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">Q0</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">Eprime</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">/</span> <span class="n">muPrime</span> <span class="o">*</span> <span class="mi">12</span> <span class="o">/</span> <span class="n">h</span> <span class="o">**</span> <span class="mi">4</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span> <span class="o">**</span> <span class="p">(</span><span class="mi">4</span> <span class="o">/</span> <span class="mi">5</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="n">ell</span><span class="o">**</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="n">muPrime</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="p">(</span><span class="n">Eprime</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="n">Q0</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">ell</span><span class="p">,</span> <span class="n">ell</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">Mesh</span><span class="o">.</span><span class="n">nx</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="c1"># one dimensional solution for average width along the width of the PKN fracture. The solution is approximated with</span>
        <span class="c1"># the power of 1/3 and not evaluate with the series.</span>
        <span class="n">sol_w</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">muPrime</span> <span class="o">/</span> <span class="mi">12</span> <span class="o">*</span> <span class="p">(</span><span class="n">Q0</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="n">Eprime</span> <span class="o">/</span> <span class="n">h</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.32</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span>
                                                                                            <span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">ell</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
        <span class="c1"># interpolation function to calculate width at any length.</span>
        <span class="n">anltcl_w</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sol_w</span><span class="p">)</span>

        <span class="c1"># cells inside the PKN fracture</span>
        <span class="n">actvElts_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">h</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">actvElts_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">ell</span><span class="p">)</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">actvElts_v</span><span class="p">,</span> <span class="n">actvElts_h</span><span class="p">)</span>

        <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Mesh</span><span class="o">.</span><span class="n">NumberOfElts</span><span class="p">,),</span> <span class="nb">float</span><span class="p">)</span>
        <span class="c1"># calculating width across the cross section of the fracture from the average width.</span>
        <span class="c1"># The average width is given by the interpolation function.</span>
        <span class="n">w</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">anltcl_w</span><span class="p">(</span><span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[</span><span class="n">actvElts</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[</span>
                                                                    <span class="n">actvElts</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">h</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="c1"># cells inside the PKN fracture</span>
        <span class="n">actvElts_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">h</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">actvElts_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">ell</span><span class="p">)</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">actvElts_v</span><span class="p">,</span> <span class="n">actvElts_h</span><span class="p">)</span>
        <span class="c1"># calculating pressure from width</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Mesh</span><span class="o">.</span><span class="n">NumberOfElts</span><span class="p">,),</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">p</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Eprime</span> <span class="o">*</span> <span class="n">anltcl_w</span><span class="p">(</span><span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[</span><span class="n">actvElts</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">h</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="c1"># todo !!! Hack: The velocity is evaluated with time taken by the fracture to acvance by one percent</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.01</span> <span class="o">*</span> <span class="n">ell</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">Q0</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">Eprime</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">/</span> <span class="n">muPrime</span> <span class="o">*</span> <span class="mi">12</span> <span class="o">/</span> <span class="n">h</span> <span class="o">**</span> <span class="mi">4</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">5</span><span class="p">))</span> <span class="o">**</span> <span class="p">(</span><span class="mi">5</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">ell</span> <span class="o">/</span> <span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">required</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">required</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span> <span class="ow">or</span> <span class="n">required</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">)):</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">ell</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">actvElts</span></div>


<span class="c1"># -----------------------------------------------------------------------------------------------------------------------</span>

<div class="viewcode-block" id="KGD_solution_K"><a class="viewcode-back" href="../doc_src/HFAnalyticalSolutions.html#HFAnalyticalSolutions.KGD_solution_K">[docs]</a><span class="k">def</span> <span class="nf">KGD_solution_K</span><span class="p">(</span><span class="n">Eprime</span><span class="p">,</span> <span class="n">Q0</span><span class="p">,</span> <span class="n">Kprime</span><span class="p">,</span> <span class="n">Mesh</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">ell</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="s1">&#39;111111&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Analytical solution plain strain hydraulic fracture (KGB geometry) in the toughness dominated regime, given current</span>
<span class="sd">    time or length. The solution does not take leak off into account.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        Eprime (float)         -- plain strain elastic modulus</span>
<span class="sd">        Q0 (float)             -- injection rate</span>
<span class="sd">        KPrime (float)         -- 4*(2/pi)**0.5 * K1c, where K1c is the linear-elastic plane-strain fracture toughness</span>
<span class="sd">        Mesh (CartesianMesh)   -- a CartesianMesh class object describing the grid.</span>
<span class="sd">        height (float)         -- the height of the KGD fracture (it should be much longer then length)</span>
<span class="sd">        ell (float)            -- length of fracture</span>
<span class="sd">        t (float)              -- the given time for which the solution is evaluated</span>


<span class="sd">    Returns:</span>
<span class="sd">        t (float)              -- time at which the fracture reaches the given length.</span>
<span class="sd">        ell (float)            -- length of the fracture at the given time</span>
<span class="sd">        p (ndarray-float)      -- pressure at each cell at the given time</span>
<span class="sd">        w (ndarray-float)      -- width at each cell at the given time</span>
<span class="sd">        v (float)              -- propagation velocity</span>
<span class="sd">        actvElts (ndarray)     -- list of cells inside the KGD fracture at the given time</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># injection rate per unit height in one wing</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="n">Q0</span> <span class="o">/</span> <span class="n">height</span>

    <span class="k">if</span> <span class="n">ell</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either the length or the time is required to evaluate the solution.&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">ell</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># length of the fracture at the given time</span>
        <span class="n">ell</span> <span class="o">=</span> <span class="mf">0.932388</span> <span class="o">*</span> <span class="p">(</span><span class="n">Eprime</span> <span class="o">*</span> <span class="n">Q</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="n">Kprime</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="mf">1.11072</span> <span class="o">*</span> <span class="n">Kprime</span> <span class="o">/</span> <span class="n">Eprime</span> <span class="o">/</span> <span class="n">Q</span> <span class="o">*</span> <span class="n">ell</span> <span class="o">**</span> <span class="p">(</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">ell</span><span class="p">,</span> <span class="n">ell</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">Mesh</span><span class="o">.</span><span class="n">nx</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="c1"># one dimensional solution for average width along the width of the PKN fracture. The solution is approximated with</span>
        <span class="c1"># the power of 1/3 and not evaluate with the series.</span>
        <span class="n">sol_w</span> <span class="o">=</span> <span class="mf">0.682784</span> <span class="o">*</span> <span class="p">(</span><span class="n">Kprime</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Q</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="n">Eprime</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">ell</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># interpolation function to calculate width at any length.</span>
        <span class="n">anltcl_w</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sol_w</span><span class="p">)</span>

        <span class="c1"># cells inside the PKN fracture</span>
        <span class="n">actvElts_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">actvElts_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">ell</span><span class="p">)</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">actvElts_v</span><span class="p">,</span> <span class="n">actvElts_h</span><span class="p">)</span>

        <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Mesh</span><span class="o">.</span><span class="n">NumberOfElts</span><span class="p">,),</span> <span class="nb">float</span><span class="p">)</span>
        <span class="c1"># The average width is given by the interpolation function.</span>
        <span class="n">w</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">=</span> <span class="n">anltcl_w</span><span class="p">(</span><span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[</span><span class="n">actvElts</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="c1"># cells inside the PKN fracture</span>
        <span class="n">actvElts_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">actvElts_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">ell</span><span class="p">)</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">actvElts_v</span><span class="p">,</span> <span class="n">actvElts_h</span><span class="p">)</span>
        <span class="c1"># calculating pressure from width</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Mesh</span><span class="o">.</span><span class="n">NumberOfElts</span><span class="p">,),</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">p</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.183074</span> <span class="o">*</span> <span class="p">(</span><span class="n">Kprime</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">/</span> <span class="p">(</span><span class="n">Eprime</span> <span class="o">*</span> <span class="n">Q0</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="c1"># todo !!! Hack: The velocity is evaluated with time taken by the fracture to acvance by one percent</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="mf">1.11072</span> <span class="o">*</span> <span class="n">Kprime</span> <span class="o">/</span> <span class="n">Eprime</span> <span class="o">/</span> <span class="n">Q</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.01</span> <span class="o">*</span> <span class="n">ell</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">ell</span> <span class="o">/</span> <span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">required</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">required</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span> <span class="ow">or</span> <span class="n">required</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">)):</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">ell</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">actvElts</span></div>


<span class="c1">#-----------------------------------------------------------------------------------------------------------------------</span>

<div class="viewcode-block" id="anisotropic_toughness_elliptical_solution"><a class="viewcode-back" href="../doc_src/HFAnalyticalSolutions.html#HFAnalyticalSolutions.anisotropic_toughness_elliptical_solution">[docs]</a><span class="k">def</span> <span class="nf">anisotropic_toughness_elliptical_solution</span><span class="p">(</span><span class="n">KIc_max</span><span class="p">,</span> <span class="n">KIc_min</span><span class="p">,</span> <span class="n">Eprime</span><span class="p">,</span> <span class="n">Q0</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="s1">&#39;111111&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Analytical solution for an elliptical fracture propagating in toughness dominated regime (see Zia and Lecampion,</span>
<span class="sd">    IJF, 2018).</span>

<span class="sd">    Arguments:</span>
<span class="sd">        KIc_max (float)        -- the fracture toughness along the minor axis</span>
<span class="sd">        KIc_min (float)        -- the fracture toughness along the major axis</span>
<span class="sd">        Eprime (float)         -- plain strain modulus</span>
<span class="sd">        Q0 (float)             -- injection rate</span>
<span class="sd">        Mesh (CartesianMesh)   -- a CartesianMesh class object describing the grid.</span>
<span class="sd">        b (float)              -- the given minor axis length</span>
<span class="sd">        t (float)              -- the given time for which the solution is evaluated</span>

<span class="sd">    Returns:</span>
<span class="sd">        t (float)              -- time at which the fracture reaches the given length.</span>
<span class="sd">        b (float)              -- length of the fracture at the given time</span>
<span class="sd">        p (ndarray-float)      -- pressure at each cell at the given time</span>
<span class="sd">        w (ndarray-float)      -- width at each cell at the given time</span>
<span class="sd">        v (float)              -- propagation velocity</span>
<span class="sd">        actvElts (ndarray)     -- list of cells inside the fracture at the given time</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">KIc_min</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Fracture toughness along both major and minor axis is to be provided! See MaterialProperties&quot;</span>
                         <span class="s2">&quot; class.&quot;</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">KIc_min</span> <span class="o">/</span> <span class="n">KIc_max</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

    <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either the minor axis length or the time is required to evaluate the solution!&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">Q0</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">c</span> <span class="o">*</span> <span class="n">Eprime</span> <span class="o">/</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">KIc_max</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mf">0.5</span> <span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">KIc_max</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">b</span><span class="o">**</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">c</span> <span class="o">*</span> <span class="n">Eprime</span> <span class="o">*</span> <span class="n">Q0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span> <span class="ow">or</span> <span class="n">required</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">KIc_max</span> <span class="o">/</span> <span class="n">KIc_min</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">b</span>
        <span class="n">eccentricity</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">b</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">a</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">rho</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># active cells (inside fracture)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">mesh</span><span class="o">.</span><span class="n">NumberOfElts</span><span class="p">,),</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">p</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">=</span> <span class="n">KIc_max</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">ellipe</span><span class="p">(</span><span class="n">eccentricity</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">mesh</span><span class="o">.</span><span class="n">NumberOfElts</span><span class="p">,))</span>
        <span class="n">w</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">b</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">mesh</span><span class="o">.</span><span class="n">CenterElts</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">Eprime</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">ellipe</span><span class="p">(</span><span class="n">eccentricity</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[</span>
                    <span class="n">actvElts</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[</span><span class="n">actvElts</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">w</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">KIc_max</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.01</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">c</span> <span class="o">*</span> <span class="n">Eprime</span> <span class="o">*</span> <span class="n">Q0</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">b</span> <span class="o">/</span> <span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">required</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">required</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span> <span class="ow">or</span> <span class="n">required</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">)):</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">actvElts</span></div>

<span class="c1">#-----------------------------------------------------------------------------------------------------------------------</span>


<div class="viewcode-block" id="TI_Elasticity_elliptical_solution"><a class="viewcode-back" href="../doc_src/HFAnalyticalSolutions.html#HFAnalyticalSolutions.TI_Elasticity_elliptical_solution">[docs]</a><span class="k">def</span> <span class="nf">TI_Elasticity_elliptical_solution</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">Cij</span><span class="p">,</span> <span class="n">Kc3</span><span class="p">,</span> <span class="n">Ep3</span><span class="p">,</span> <span class="n">Q0</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="s1">&#39;111111&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Analytical solution for an elliptical fracture propagating in toughness dominated regime (see Zia and Lecampion,</span>
<span class="sd">    IJF, 2018).</span>

<span class="sd">    Arguments:</span>
<span class="sd">        Mesh (CartesianMesh)   -- a CartesianMesh class object describing the grid.</span>
<span class="sd">        b (float)              -- the given minor axis length</span>
<span class="sd">        a (float)              -- the given major axis length</span>
<span class="sd">        p (float)              -- pressure</span>

<span class="sd">    Returns:</span>
<span class="sd">        w (ndarray-float)      -- width at each cell at the given time</span>

<span class="sd">        actvElts (ndarray)     -- list of cells inside the fracture at the given time</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either the minor axis length or time is to be provided!&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">Q0</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">Ep3</span> <span class="o">/</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">Kc3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mf">0.5</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">b</span><span class="o">**</span><span class="p">(</span><span class="mi">5</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">Kc3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">Q0</span> <span class="o">*</span> <span class="n">Ep3</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span> <span class="ow">or</span> <span class="n">required</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">b</span>

        <span class="n">C11</span> <span class="o">=</span> <span class="n">Cij</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">C12</span> <span class="o">=</span> <span class="n">Cij</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">C13</span> <span class="o">=</span> <span class="n">Cij</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="n">C33</span> <span class="o">=</span> <span class="n">Cij</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="n">C44</span> <span class="o">=</span> <span class="n">Cij</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
        <span class="n">C66</span> <span class="o">=</span> <span class="n">Cij</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

        <span class="n">m1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">C13</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">C11</span> <span class="o">*</span> <span class="n">C33</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">C13</span> <span class="o">*</span> <span class="n">C44</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">C44</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">((</span><span class="n">C13</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">C11</span> <span class="o">*</span> <span class="n">C33</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">C13</span> <span class="o">**</span> <span class="mi">2</span>
                    <span class="o">-</span> <span class="n">C11</span> <span class="o">*</span> <span class="n">C33</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">C13</span> <span class="o">*</span> <span class="n">C44</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">C44</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
                         <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">C13</span> <span class="o">*</span> <span class="n">C44</span> <span class="o">+</span> <span class="n">C44</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">m2</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">C13</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">C11</span> <span class="o">*</span> <span class="n">C33</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">C13</span> <span class="o">*</span> <span class="n">C44</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">C44</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">((</span><span class="n">C13</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">C11</span> <span class="o">*</span> <span class="n">C33</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">C13</span> <span class="o">**</span> <span class="mi">2</span>
                    <span class="o">-</span> <span class="n">C11</span> <span class="o">*</span> <span class="n">C33</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">C13</span> <span class="o">*</span> <span class="n">C44</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">C44</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
                         <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">C13</span> <span class="o">*</span> <span class="n">C44</span> <span class="o">+</span> <span class="n">C44</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>

        <span class="n">gamma3</span> <span class="o">=</span> <span class="p">(</span><span class="n">C44</span> <span class="o">/</span> <span class="n">C66</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>

        <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">Cij</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">gamma3</span><span class="p">)</span>

        <span class="n">sigma_intgrl</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">TI_elasticity_sigma</span><span class="p">,</span>
                                      <span class="mi">0</span><span class="p">,</span>
                                      <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span>
                                      <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span>
                                      <span class="n">points</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">w0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="n">m2</span> <span class="o">-</span> <span class="n">m1</span><span class="p">)</span> <span class="o">*</span> <span class="n">gamma3</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">C66</span> <span class="o">*</span> <span class="n">sigma_intgrl</span><span class="p">)</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">rho</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># active cells (inside fracture)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">mesh</span><span class="o">.</span><span class="n">NumberOfElts</span><span class="p">,</span> <span class="p">),</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">p</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">Kc3</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">w0</span> <span class="o">*</span> <span class="n">Ep3</span><span class="p">)</span>

        <span class="n">u0</span> <span class="o">=</span> <span class="n">w0</span> <span class="o">*</span> <span class="n">p</span> <span class="o">*</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">a</span>

        <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">mesh</span><span class="o">.</span><span class="n">NumberOfElts</span><span class="p">,))</span>
        <span class="n">w</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">=</span> <span class="n">u0</span><span class="p">[</span><span class="n">actvElts</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[</span><span class="n">actvElts</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span>
                                        <span class="n">mesh</span><span class="o">.</span><span class="n">CenterCoor</span><span class="p">[</span><span class="n">actvElts</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">w</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">actvElts</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">actvElts</span></div>


<span class="c1">#-----------------------------------------------------------------------------------------------------------------------</span>

<div class="viewcode-block" id="TI_elasticity_sigma"><a class="viewcode-back" href="../doc_src/HFAnalyticalSolutions.html#HFAnalyticalSolutions.TI_elasticity_sigma">[docs]</a><span class="k">def</span> <span class="nf">TI_elasticity_sigma</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>

    <span class="p">(</span><span class="n">stiff_tensor</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">gamma3</span><span class="p">)</span> <span class="o">=</span> <span class="n">args</span>

    <span class="n">C11</span> <span class="o">=</span> <span class="n">stiff_tensor</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">C13</span> <span class="o">=</span> <span class="n">stiff_tensor</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">C44</span> <span class="o">=</span> <span class="n">stiff_tensor</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

    <span class="n">gamma1</span> <span class="o">=</span> <span class="p">((</span><span class="n">C44</span> <span class="o">+</span> <span class="n">m1</span> <span class="o">*</span> <span class="p">(</span><span class="n">C13</span> <span class="o">+</span> <span class="n">C44</span><span class="p">))</span> <span class="o">/</span> <span class="n">C11</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
    <span class="n">gamma2</span> <span class="o">=</span> <span class="p">((</span><span class="n">C44</span> <span class="o">+</span> <span class="n">m2</span> <span class="o">*</span> <span class="p">(</span><span class="n">C13</span> <span class="o">+</span> <span class="n">C44</span><span class="p">))</span> <span class="o">/</span> <span class="n">C11</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>

    <span class="n">h1</span> <span class="o">=</span> <span class="p">(</span><span class="n">m1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">gamma3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">h2</span> <span class="o">=</span> <span class="p">(</span><span class="n">m2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">gamma3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

    <span class="n">xi1</span> <span class="o">=</span> <span class="p">((</span><span class="n">gamma1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
    <span class="n">xi2</span> <span class="o">=</span> <span class="p">((</span><span class="n">gamma2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
    <span class="n">xi3</span> <span class="o">=</span> <span class="p">((</span><span class="n">gamma3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>

    <span class="n">rgam</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>

    <span class="n">dd</span> <span class="o">=</span> <span class="n">m2</span> <span class="o">*</span> <span class="n">h1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">xi2</span> <span class="o">-</span> <span class="n">m1</span> <span class="o">*</span> <span class="n">h2</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">xi1</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="n">m1</span> <span class="o">-</span> <span class="n">m2</span><span class="p">)</span> <span class="o">*</span> <span class="n">xi2</span> <span class="o">*</span> <span class="n">xi1</span> <span class="o">*</span> <span class="n">xi3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

    <span class="n">sigma</span> <span class="o">=</span> <span class="n">dd</span> <span class="o">/</span> <span class="p">(</span><span class="n">xi1</span> <span class="o">*</span> <span class="n">xi2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rgam</span> <span class="o">**</span> <span class="mi">3</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sigma</span></div>

<span class="c1">#-----------------------------------------------------------------------------------------------------------------------</span>


<div class="viewcode-block" id="HF_analytical_sol"><a class="viewcode-back" href="../doc_src/HFAnalyticalSolutions.html#HFAnalyticalSolutions.HF_analytical_sol">[docs]</a><span class="k">def</span> <span class="nf">HF_analytical_sol</span><span class="p">(</span><span class="n">regime</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">Eprime</span><span class="p">,</span> <span class="n">Q0</span><span class="p">,</span> <span class="n">muPrime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Kprime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Cprime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">Kc_1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Cij</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="s1">&#39;111111&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function provides the analytical solution for the given parameters according to the given propagation regime</span>

<span class="sd">    Arguments:</span>
<span class="sd">        regime (string)        -- the propagation regime. Possible options:</span>
<span class="sd">                                    - K  (toughness dominated regime, without leak off)</span>
<span class="sd">                                    - M  (viscosity dominated regime, without leak off)</span>
<span class="sd">                                    - Kt (viscosity dominated regime , with leak off)</span>
<span class="sd">                                    - Mt (viscosity dominated regime , with leak off)</span>
<span class="sd">                                    - PKN (height contained hydraulic fracture with PKN geometry)</span>
<span class="sd">                                    - E (elliptical fracture propagating in toughness dominated regime).</span>
<span class="sd">        mesh (CartesianMesh)   -- a CartesianMesh class object describing the grid.</span>
<span class="sd">        Eprime (float)         -- plain strain modulus.</span>
<span class="sd">        Q0 (float)             -- injection rate.</span>
<span class="sd">        muPrime (float)        -- 12*viscosity.</span>
<span class="sd">        Kprime (float)         -- the fracture toughness (K&#39;) along the minor axis.</span>
<span class="sd">        Cprime (float)         -- 2*C, where C is the Carter&#39;s leak off coefficient.</span>
<span class="sd">        length (float)         -- the given length dimension (fracture length in the case of PKN, length of the minor</span>
<span class="sd">                                  axis in the case of elliptical fracture and the fracture radius in all of the rest).</span>
<span class="sd">        t (float)              -- the given time for which the solution is evaluated.</span>
<span class="sd">        Kp_perp (float)        -- the fracture toughness along the major axis.</span>
<span class="sd">        h (float)              -- the height of the PKN fracture.</span>

<span class="sd">    Returns:</span>
<span class="sd">        t (float)              -- time at which the fracture reaches the given length.</span>
<span class="sd">        r (float)              -- length of the fracture at the given time (fracture length in the case of PKN, length</span>
<span class="sd">                                  of the minor axis in the case of elliptical fracture and the fracture radius in all</span>
<span class="sd">                                  of the rest).</span>
<span class="sd">        p (ndarray-float)      -- pressure at each cell at the given time.</span>
<span class="sd">        w (ndarray-float)      -- width at each cell at the given time.</span>
<span class="sd">        v (float)              -- propagation velocity.</span>
<span class="sd">        actvElts (ndarray)     -- list of cells inside the fracture at the given time.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">regime</span> <span class="ow">is</span> <span class="s1">&#39;M&#39;</span><span class="p">:</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">actvElts</span> <span class="o">=</span> <span class="n">M_vertex_solution</span><span class="p">(</span><span class="n">Eprime</span><span class="p">,</span> <span class="n">Q0</span><span class="p">,</span> <span class="n">muPrime</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">required</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">regime</span> <span class="ow">is</span> <span class="s1">&#39;K&#39;</span><span class="p">:</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">actvElts</span> <span class="o">=</span> <span class="n">K_vertex_solution</span><span class="p">(</span><span class="n">Kprime</span><span class="p">,</span> <span class="n">Eprime</span><span class="p">,</span> <span class="n">Q0</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">required</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">regime</span> <span class="ow">is</span> <span class="s1">&#39;Mt&#39;</span><span class="p">:</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">actvElts</span> <span class="o">=</span> <span class="n">Mt_vertex_solution</span><span class="p">(</span><span class="n">Eprime</span><span class="p">,</span> <span class="n">Cprime</span><span class="p">,</span> <span class="n">Q0</span><span class="p">,</span> <span class="n">muPrime</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">required</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">regime</span> <span class="ow">is</span> <span class="s1">&#39;Kt&#39;</span><span class="p">:</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">actvElts</span> <span class="o">=</span> <span class="n">KT_vertex_solution</span><span class="p">(</span><span class="n">Eprime</span><span class="p">,</span> <span class="n">Cprime</span><span class="p">,</span> <span class="n">Q0</span><span class="p">,</span> <span class="n">Kprime</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">required</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">regime</span> <span class="ow">is</span> <span class="s1">&#39;PKN&#39;</span><span class="p">:</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">actvElts</span> <span class="o">=</span> <span class="n">PKN_solution</span><span class="p">(</span><span class="n">Eprime</span><span class="p">,</span> <span class="n">Q0</span><span class="p">,</span> <span class="n">muPrime</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">required</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">regime</span> <span class="ow">is</span> <span class="s1">&#39;KGD_K&#39;</span><span class="p">:</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">actvElts</span> <span class="o">=</span> <span class="n">KGD_solution_K</span><span class="p">(</span><span class="n">Eprime</span><span class="p">,</span> <span class="n">Q0</span><span class="p">,</span> <span class="n">Kprime</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">required</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">regime</span> <span class="ow">is</span> <span class="s1">&#39;MDR&#39;</span><span class="p">:</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">actvElts</span> <span class="o">=</span> <span class="n">MDR_M_vertex_solution</span><span class="p">(</span><span class="n">Eprime</span><span class="p">,</span> <span class="n">Q0</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">muPrime</span><span class="o">/</span><span class="mf">12.</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">required</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">regime</span> <span class="ow">is</span> <span class="s1">&#39;E_K&#39;</span><span class="p">:</span>
        <span class="n">Kc_3</span> <span class="o">=</span> <span class="n">Kprime</span> <span class="o">/</span> <span class="p">(</span><span class="mi">32</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">actvElts</span> <span class="o">=</span> <span class="n">anisotropic_toughness_elliptical_solution</span><span class="p">(</span> <span class="n">Kc_3</span><span class="p">,</span> <span class="n">Kc_1</span><span class="p">,</span> <span class="n">Eprime</span><span class="p">,</span> <span class="n">Q0</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span>
                                                                             <span class="n">required</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">regime</span> <span class="ow">is</span> <span class="s1">&#39;E_E&#39;</span><span class="p">:</span>
        <span class="n">Kc_3</span> <span class="o">=</span> <span class="n">Kprime</span> <span class="o">/</span> <span class="p">(</span><span class="mi">32</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">actvElts</span> <span class="o">=</span> <span class="n">TI_Elasticity_elliptical_solution</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">Cij</span><span class="p">,</span> <span class="n">Kc_3</span><span class="p">,</span> <span class="n">Eprime</span><span class="p">,</span> <span class="n">Q0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span>
                                                                    <span class="n">required</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">actvElts</span></div>

<span class="c1">#-----------------------------------------------------------------------------------------------------------------------</span>


<div class="viewcode-block" id="get_fracture_dimensions_analytical"><a class="viewcode-back" href="../doc_src/HFAnalyticalSolutions.html#HFAnalyticalSolutions.get_fracture_dimensions_analytical">[docs]</a><span class="k">def</span> <span class="nf">get_fracture_dimensions_analytical</span><span class="p">(</span><span class="n">regime</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Eprime</span><span class="p">,</span> <span class="n">Q0</span><span class="p">,</span> <span class="n">muPrime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Kprime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Cprime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">Kc_1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">regime</span> <span class="ow">is</span> <span class="s1">&#39;M&#39;</span><span class="p">:</span>
        <span class="n">x_len</span> <span class="o">=</span> <span class="n">y_len</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.6976</span> <span class="o">*</span> <span class="n">Eprime</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">9</span><span class="p">)</span> <span class="o">*</span> <span class="n">Q0</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span> <span class="o">**</span> <span class="p">(</span><span class="mi">4</span> <span class="o">/</span> <span class="mi">9</span><span class="p">))</span> <span class="o">/</span> <span class="n">muPrime</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">9</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">regime</span> <span class="ow">is</span> <span class="s1">&#39;K&#39;</span><span class="p">:</span>
        <span class="n">x_len</span> <span class="o">=</span> <span class="n">y_len</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">Q0</span> <span class="o">*</span> <span class="n">Eprime</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="n">Kprime</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.4</span>
    <span class="k">elif</span> <span class="n">regime</span> <span class="ow">is</span> <span class="s1">&#39;Mt&#39;</span><span class="p">:</span>
        <span class="n">x_len</span> <span class="o">=</span> <span class="n">y_len</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Q0</span> <span class="o">/</span> <span class="n">Cprime</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span> <span class="o">**</span> <span class="mf">0.25</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="k">elif</span> <span class="n">regime</span> <span class="ow">is</span> <span class="s1">&#39;Kt&#39;</span><span class="p">:</span>
        <span class="n">x_len</span> <span class="o">=</span> <span class="n">y_len</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">Q0</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span> <span class="o">/</span> <span class="n">Cprime</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="k">elif</span> <span class="n">regime</span> <span class="ow">is</span> <span class="s1">&#39;PKN&#39;</span><span class="p">:</span>
        <span class="n">x_len</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">Q0</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">Eprime</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">/</span> <span class="n">muPrime</span> <span class="o">*</span> <span class="mi">12</span> <span class="o">/</span> <span class="n">h</span> <span class="o">**</span> <span class="mi">4</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span> <span class="o">**</span> <span class="p">(</span><span class="mi">4</span> <span class="o">/</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">y_len</span> <span class="o">=</span> <span class="n">h</span>
    <span class="k">elif</span> <span class="n">regime</span> <span class="ow">is</span> <span class="s1">&#39;KGD_K&#39;</span><span class="p">:</span>
        <span class="n">x_len</span> <span class="o">=</span> <span class="mf">0.932388</span> <span class="o">*</span> <span class="p">(</span><span class="n">Eprime</span> <span class="o">*</span> <span class="n">Q0</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="n">Kprime</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">y_len</span> <span class="o">=</span> <span class="n">h</span>
    <span class="k">elif</span> <span class="n">regime</span> <span class="ow">is</span> <span class="s1">&#39;MDR&#39;</span><span class="p">:</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="mf">1.78</span>
        <span class="n">gammam</span> <span class="o">=</span> <span class="mf">0.758244</span>
        <span class="n">x_len</span> <span class="o">=</span> <span class="n">y_len</span> <span class="o">=</span> <span class="n">gammam</span> <span class="o">*</span> <span class="p">((</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="mf">14.</span> <span class="o">/</span> <span class="mi">87</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">Eprime</span> <span class="o">**</span> <span class="p">(</span><span class="mf">10.</span> <span class="o">/</span> <span class="mi">87</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">Q0</span> <span class="o">**</span> <span class="p">(</span><span class="mf">9.</span> <span class="o">/</span> <span class="mi">29</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">**</span> <span class="p">(</span><span class="mi">40</span> <span class="o">/</span> <span class="mi">87</span><span class="p">))</span>
                    <span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="mi">3</span> <span class="o">**</span> <span class="p">(</span><span class="mf">7.</span> <span class="o">/</span> <span class="mi">87</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">fo</span> <span class="o">**</span> <span class="p">(</span><span class="mf">10.</span> <span class="o">/</span> <span class="mi">87</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span><span class="n">muPrime</span> <span class="o">/</span> <span class="mi">12</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mf">7.</span> <span class="o">/</span> <span class="mi">87</span><span class="p">))</span> <span class="o">*</span> <span class="n">density</span> <span class="o">**</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="mi">29</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">regime</span> <span class="ow">is</span> <span class="s1">&#39;E_K&#39;</span><span class="p">:</span>
        <span class="n">Kc_3</span> <span class="o">=</span> <span class="n">Kprime</span> <span class="o">/</span> <span class="p">(</span><span class="mi">32</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
        <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">Kc_1</span> <span class="o">/</span> <span class="n">Kc_3</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">y_len</span> <span class="o">=</span> <span class="p">(</span><span class="n">Q0</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">c</span> <span class="o">*</span> <span class="n">Eprime</span> <span class="o">/</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">Kc_3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">))</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">x_len</span> <span class="o">=</span> <span class="n">y_len</span> <span class="o">/</span> <span class="n">c</span>
    <span class="k">elif</span> <span class="n">regime</span> <span class="ow">is</span> <span class="s1">&#39;E_E&#39;</span><span class="p">:</span>
        <span class="n">Kc_3</span> <span class="o">=</span> <span class="n">Kprime</span> <span class="o">/</span> <span class="p">(</span><span class="mi">32</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
        <span class="n">y_len</span> <span class="o">=</span> <span class="p">(</span><span class="n">Q0</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">Eprime</span> <span class="o">/</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">Kc_3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">))</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">x_len</span> <span class="o">=</span> <span class="n">y_len</span> <span class="o">*</span> <span class="n">gamma</span>

    <span class="k">return</span> <span class="n">x_len</span><span class="p">,</span> <span class="n">y_len</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PyFrac 1.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Haseeb Zia.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.
    </div>
  </body>
</html>